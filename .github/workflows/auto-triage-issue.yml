      - name: Apply labels based on issue content and create branch
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const issue = context.payload.issue;
            const title = issue.title.toLowerCase();
            const body = issue.body || "";
            const issueNumber = issue.number;
            const labels = [];

            const isBug = title.includes('bug') || body.toLowerCase().includes('error');
            const isFeature = title.includes('feature') || body.toLowerCase().includes('enhancement');

            if (isBug) labels.push('bug');
            if (isFeature) labels.push('enhancement');

            if (labels.length > 0) {
              await github.rest.issues.addLabels({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: issueNumber,
                labels,
              });
            }

            // ✅ Determine branch type
            const branchType = isBug ? 'hotfix' : isFeature ? 'feature' : null;
            if (!branchType) {
              console.log("Not a bug or feature, skipping branch creation.");
              return;
            }

            // ✅ Extract "shortname" from issue body using regex
            const shortnameMatch = body.match(/###\s*Short Name\s*\n([\s\S]*?)\n\s*###/i) || 
                                   body.match(/(?<=short name[:]*\s*)([a-zA-Z0-9-_]+)/i);

            const shortname = shortnameMatch ? shortnameMatch[1].trim().toLowerCase().replace(/[^a-z0-9-]/g, '-') : 'no-title';

            const branchName = `${branchType}/${issueNumber}-${shortname}`.substring(0, 50);

            // ✅ Get latest commit SHA from main
            const mainBranch = await github.rest.repos.getBranch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              branch: 'main',
            });

            const mainSha = mainBranch.data.commit.sha;

            // ✅ Cr
